__nuqasm2_ast.md 2019-04-07__

Intro
-----

nuqasm2 is a proof of concept of an OPENQASM (and potentially OPENPULSE) parser
generating an abstract syntax tree (AST) to be consumed by other code generators.

It was coded without any particular comp sci angle and without much insight into
current AST generators used by IBM Qiskit.

Here is documented what was coded, not as a prescription nor as a proposal, but
to facilitate discussion on the Qiskit team.

The current as-is implementation is described unless otherwise noted.

AST Structure
=============

nuqasm2 reads OPENQASM 2.0 files, recursively descending into included files, and outputs Python unordered dictionary which may be consumed by another module or
pretty-printed.

The dictionary has 4 string keys:

* `t_sect`	translation section
* `c_sect`	the code section
* `s_sect`	source section
* `g_sect`	gate definition section

<h3><pre>t_sect</pre></h3>

The `t_sect` is an unordered dictionary of information about the entire translation unit. The keys are as follows:

* `datetime_start` is the datetime stamp of the start of translation.
* `datetime_finish` is the datetime stamp of the end of translation.
* `filepaths` is an ordered list of filepaths visited in the translation unit.
  * It comprises the top-level source file and all included files.
  * The zero-based index of each filepath in the list is used in other sections as `filenum`.
  * The filepaths may be relative or absolute, depending on how they were expressed to the translator.

<h3><pre>c_sect</pre></h3>

The `c_sect` is an ordered list of dictionaries. Each dictionary represents one parsed entity. The entity is typically a line, though entities in qasm source code occasionally span lines.

Translation is case-agnostic and simply passes thru entities in their original case as read from source.

The keys to these entity dictionaries are as follows:

* `type` element type (discussed below)
* `filenum` zero-based index into `t_sect`'s list of files visited
* `linenum` zero-based line number in the file represented by `filenum`.
  * In the case where an entity spans lines, `linenum` always refers to the first line.
* `source` the source code for the entity, though source preservation is optional and the value of this key may be `None`
  * `source` is always present as a key in the current implementation, but probably should be omitted like `eol_comment` when source is not preserved.
* `op` is the operator if the entity is an operation.
* `param_list` is an ordered list of parameters to a parenthesized operator.
  * `param_list` is always present as a key in the current implementation, but probably should be omitted like `eol_comment` when there is no parenthesized parameter list.
* `reg_list` is an ordered list of the register arguments to an operator.
* `source_reg` is the source of measurement.
* `target_reg` is the target of measurement.

Not all keys are present for every type. Also, certain keys normal to a type may be present or absent depending on circumstance, for instance, `'eol_comment'` indicating an end-of-line comment is absent if the qasm line which was parsed contained no end-of-line comment.

The most important key is `'type'` which defines what sort of entity has been parsed. The keys for `type` are defined in the code as follows:

<pre><font color="#000000"><font color="#006699"><strong>class</strong></font> <font color="#9966ff">ASTType</font><font color="#000000"><strong>(</strong></font>Enum<font color="#000000"><strong>)</strong></font><font color="#006699"><strong>:</strong></font>
    <font color="#cc00cc">&quot;&quot;&quot;</font><font color="#cc00cc">Enums</font><font color="#cc00cc"> </font><font color="#cc00cc">designating</font><font color="#cc00cc"> </font><font color="#cc00cc">element</font><font color="#cc00cc"> </font><font color="#cc00cc">types</font><font color="#cc00cc">.</font><font color="#cc00cc">&quot;&quot;&quot;</font>
    UNKNOWN <font color="#000000"><strong>=</strong></font> <font color="#ff0000">0</font>
    COMMENT <font color="#000000"><strong>=</strong></font> <font color="#ff0000">100</font>
    QREG <font color="#000000"><strong>=</strong></font> <font color="#ff0000">20</font>
    CREG <font color="#000000"><strong>=</strong></font> <font color="#ff0000">30</font>
    MEASURE <font color="#000000"><strong>=</strong></font> <font color="#ff0000">40</font>
    BARRIER <font color="#000000"><strong>=</strong></font> <font color="#ff0000">50</font>
    GATE <font color="#000000"><strong>=</strong></font> <font color="#ff0000">60</font>
    OP <font color="#000000"><strong>=</strong></font> <font color="#ff0000">70</font>
    CTL <font color="#000000"><strong>=</strong></font> <font color="#ff0000">80</font>
    CTL_2 <font color="#000000"><strong>=</strong></font> <font color="#ff0000">82</font>
    BLANK <font color="#000000"><strong>=</strong></font> <font color="#ff0000">1000</font>
    DECLARATION_QASM_2_0 <font color="#000000"><strong>=</strong></font> <font color="#ff0000">2000</font>
    INCLUDE <font color="#000000"><strong>=</strong></font> <font color="#ff0000">3000</font>
</font></pre>

<h3><pre>s_sect</pre></h3>
If source was optionally preserved by translation,
`s_sect` is an ordered list of unordered dictionaries, each representing a file visited in translation. Each dictionary has 2 keys:
* `filenum` is the zero-based index into `t_sect`'s list of files visited.
* `source` is an ordered list of source code lines for the visited file.

<h3><pre>g_sect</pre></h3>

The `g_sect` is an ordered list of unordered dictionaries, each representing one `gate` definition in the source.

nuqasm2 does not expand gate definitions in the `c_sect`. The next level of translation after nuqasm2 must interpret operators in light of its own understanding supplemented by the gate definitions in the `g_sect`.

Comment lines from `include`d files appear in the `c_sect` but no gate definitions, whose source and output are entirely relegated to the `g_sect`.

Each dictionary representing a gate definition presents the following keys:

* `filenum` is the zero-based index into `t_sect`'s list of files visited.
* `linenum` is the zero-based line number in the file represented by `filenum`.
* `gate_name` is the game name.
* `gate_ops_list` is an ordered list of unordered dictionaries describing the gate being defined.
  * `op` is the gate name.
  * `op_param_list` is an ordered list of parameters  for gates taking a parenthesized parameter list. For gates without such a list the value is `None`.
  * `gate_ops_raw_list` is the original gate declaration.
  * `source` is the source code, if source is optionally preserved.


Example: `ghzyyx.qasm`
----------------------

An example qasm2 file is given below, followed by its nuqasm2 translation.

<pre><font color="#000000"><font color="#cc0000">//</font><font color="#cc0000"> </font><font color="#cc0000">ghzyyx</font>
<font color="#006699"><strong>OPENQASM</strong></font> <font color="#ff0000">2</font>.<font color="#ff0000">0</font>;
<font color="#006699"><strong>include</strong></font> <font color="#ff00cc">&quot;</font><font color="#ff00cc">qelib1.inc</font><font color="#ff00cc">&quot;</font>;
<font color="#0099ff"><strong>qreg</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">3</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>creg</strong></font> c<font color="#000000"><strong>[</strong></font><font color="#ff0000">3</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>x</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">0</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>h</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">1</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>h</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">2</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>cx</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">1</font><font color="#000000"><strong>]</strong></font>,q<font color="#000000"><strong>[</strong></font><font color="#ff0000">0</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>cx</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">2</font><font color="#000000"><strong>]</strong></font>,q<font color="#000000"><strong>[</strong></font><font color="#ff0000">0</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>h</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">0</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>h</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">1</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>h</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">2</font><font color="#000000"><strong>]</strong></font>;
<font color="#009966"><strong>barrier</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">0</font><font color="#000000"><strong>]</strong></font>,q<font color="#000000"><strong>[</strong></font><font color="#ff0000">1</font><font color="#000000"><strong>]</strong></font>,q<font color="#000000"><strong>[</strong></font><font color="#ff0000">2</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>sdg</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">1</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>sdg</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">2</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>h</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">0</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>h</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">1</font><font color="#000000"><strong>]</strong></font>;
<font color="#0099ff"><strong>h</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">2</font><font color="#000000"><strong>]</strong></font>;
<font color="#009966"><strong>measure</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">0</font><font color="#000000"><strong>]</strong></font> <font color="#000000"><strong>-&gt;</strong></font> c<font color="#000000"><strong>[</strong></font><font color="#ff0000">0</font><font color="#000000"><strong>]</strong></font>;
<font color="#009966"><strong>measure</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">1</font><font color="#000000"><strong>]</strong></font> <font color="#000000"><strong>-&gt;</strong></font> c<font color="#000000"><strong>[</strong></font><font color="#ff0000">1</font><font color="#000000"><strong>]</strong></font>;
<font color="#009966"><strong>measure</strong></font> q<font color="#000000"><strong>[</strong></font><font color="#ff0000">2</font><font color="#000000"><strong>]</strong></font> <font color="#000000"><strong>-&gt;</strong></font> c<font color="#000000"><strong>[</strong></font><font color="#ff0000">2</font><font color="#000000"><strong>]</strong></font>;
</font></pre>

```
{   'c_sect': [   {   'filenum': 0,
                      'linenum': 0,
                      'source': '// ghzyyx',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 0,
                      'linenum': 1,
                      'source': 'OPENQASM 2.0;',
                      'type': <ASTType.DECLARATION_QASM_2_0: 2000>},
                  {   'filenum': 0,
                      'include': 'qelib1.inc',
                      'linenum': 2,
                      'source': 'include "qelib1.inc";',
                      'type': <ASTType.INCLUDE: 3000>},
                  {   'filenum': 1,
                      'linenum': 0,
                      'source': '// Quantum Experience (QE) Standard Header',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 1,
                      'source': '// file: qelib1.inc',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 3,
                      'source': '// --- QE Hardware primitives ---',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 5,
                      'source': '// 3-parameter 2-pulse single qubit gate',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 7,
                      'source': '// 2-parameter 1-pulse single qubit gate',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 9,
                      'source': '// 1-parameter 0-pulse single qubit gate',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 11,
                      'source': '// controlled-NOT',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 13,
                      'source': '// idle gate (identity)',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 15,
                      'source': '// idle gate (identity) with length '
                                'gamma*sqglen',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 18,
                      'source': '// --- QE Standard Gates ---',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 20,
                      'source': '// Pauli gate: bit-flip',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 22,
                      'source': '// Pauli gate: bit and phase flip',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 24,
                      'source': '// Pauli gate: phase flip',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 26,
                      'source': '// Clifford gate: Hadamard',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 28,
                      'source': '// Clifford gate: sqrt(Z) phase gate',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 30,
                      'source': '// Clifford gate: conjugate of sqrt(Z)',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 32,
                      'source': '// C3 gate: sqrt(S) phase gate',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 34,
                      'source': '// C3 gate: conjugate of sqrt(S)',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 37,
                      'source': '// --- Standard rotations ---',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 38,
                      'source': '// Rotation around X-axis',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 40,
                      'source': '// rotation around Y-axis',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 42,
                      'source': '// rotation around Z axis',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 45,
                      'source': '// --- QE Standard User-Defined Gates  ---',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 47,
                      'source': '// controlled-Phase',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 49,
                      'source': '// controlled-Y',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 51,
                      'source': '// swap',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 53,
                      'source': '// controlled-H',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 61,
                      'source': '// C3 gate: Toffoli',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 72,
                      'source': '// cswap (Fredkin)',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 79,
                      'source': '// controlled rz rotation',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 87,
                      'source': '// controlled phase rotation',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 96,
                      'source': '// controlled-U',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 1,
                      'linenum': 106,
                      'source': '// two-qubit ZZ rotation',
                      'type': <ASTType.COMMENT: 100>},
                  {   'filenum': 0,
                      'linenum': 3,
                      'qreg_name': 'q',
                      'qreg_num': '3',
                      'source': 'qreg q[3];',
                      'type': <ASTType.QREG: 20>},
                  {   'creg_name': 'c',
                      'creg_num': '3',
                      'filenum': 0,
                      'linenum': 4,
                      'source': 'creg c[3];',
                      'type': <ASTType.CREG: 30>},
                  {   'filenum': 0,
                      'linenum': 5,
                      'op': 'x',
                      'param_list': None,
                      'reg_list': ['q[0]'],
                      'source': 'x q[0];',
                      'type': <ASTType.OP: 70>},
                  {   'filenum': 0,
                      'linenum': 6,
                      'op': 'h',
                      'param_list': None,
                      'reg_list': ['q[1]'],
                      'source': 'h q[1];',
                      'type': <ASTType.OP: 70>},
                  {   'filenum': 0,
                      'linenum': 7,
                      'op': 'h',
                      'param_list': None,
                      'reg_list': ['q[2]'],
                      'source': 'h q[2];',
                      'type': <ASTType.OP: 70>},
                  {   'filenum': 0,
                      'linenum': 8,
                      'op': 'cx',
                      'param_list': None,
                      'reg_list': ['q[1]', 'q[0]'],
                      'source': 'cx q[1],q[0];',
                      'type': <ASTType.OP: 70>},
                  {   'filenum': 0,
                      'linenum': 9,
                      'op': 'cx',
                      'param_list': None,
                      'reg_list': ['q[2]', 'q[0]'],
                      'source': 'cx q[2],q[0];',
                      'type': <ASTType.OP: 70>},
                  {   'filenum': 0,
                      'linenum': 10,
                      'op': 'h',
                      'param_list': None,
                      'reg_list': ['q[0]'],
                      'source': 'h q[0];',
                      'type': <ASTType.OP: 70>},
                  {   'filenum': 0,
                      'linenum': 11,
                      'op': 'h',
                      'param_list': None,
                      'reg_list': ['q[1]'],
                      'source': 'h q[1];',
                      'type': <ASTType.OP: 70>},
                  {   'filenum': 0,
                      'linenum': 12,
                      'op': 'h',
                      'param_list': None,
                      'reg_list': ['q[2]'],
                      'source': 'h q[2];',
                      'type': <ASTType.OP: 70>},
                  {   'filenum': 0,
                      'linenum': 13,
                      'reg_list': ['q[0]', 'q[1]', 'q[2]'],
                      'source': 'barrier q[0],q[1],q[2];',
                      'type': <ASTType.BARRIER: 50>},
                  {   'filenum': 0,
                      'linenum': 14,
                      'op': 'sdg',
                      'param_list': None,
                      'reg_list': ['q[1]'],
                      'source': 'sdg q[1];',
                      'type': <ASTType.OP: 70>},
                  {   'filenum': 0,
                      'linenum': 15,
                      'op': 'sdg',
                      'param_list': None,
                      'reg_list': ['q[2]'],
                      'source': 'sdg q[2];',
                      'type': <ASTType.OP: 70>},
                  {   'filenum': 0,
                      'linenum': 16,
                      'op': 'h',
                      'param_list': None,
                      'reg_list': ['q[0]'],
                      'source': 'h q[0];',
                      'type': <ASTType.OP: 70>},
                  {   'filenum': 0,
                      'linenum': 17,
                      'op': 'h',
                      'param_list': None,
                      'reg_list': ['q[1]'],
                      'source': 'h q[1];',
                      'type': <ASTType.OP: 70>},
                  {   'filenum': 0,
                      'linenum': 18,
                      'op': 'h',
                      'param_list': None,
                      'reg_list': ['q[2]'],
                      'source': 'h q[2];',
                      'type': <ASTType.OP: 70>},
                  {   'filenum': 0,
                      'linenum': 19,
                      'source': 'measure q[0] -> c[0];',
                      'source_reg': 'q[0]',
                      'target_reg': 'c[0]',
                      'type': <ASTType.MEASURE: 40>},
                  {   'filenum': 0,
                      'linenum': 20,
                      'source': 'measure q[1] -> c[1];',
                      'source_reg': 'q[1]',
                      'target_reg': 'c[1]',
                      'type': <ASTType.MEASURE: 40>},
                  {   'filenum': 0,
                      'linenum': 21,
                      'source': 'measure q[2] -> c[2];',
                      'source_reg': 'q[2]',
                      'target_reg': 'c[2]',
                      'type': <ASTType.MEASURE: 40>}],
    'g_sect': [   {   'filenum': 1,
                      'gate_name': 'u3(theta,phi,lambda)',
                      'gate_ops_list': [   {   'op': 'U',
                                               'op_param_list': [   'theta',
                                                                    'phi',
                                                                    'lambda'],
                                               'op_reg_list': ['q']}],
                      'gate_ops_raw_list': ['U(theta,phi,lambda) q;'],
                      'gate_param_list': ['q'],
                      'linenum': 6,
                      'source': 'gate u3(theta,phi,lambda) q { '
                                'U(theta,phi,lambda) q; }'},
                  {   'filenum': 1,
                      'gate_name': 'u2(phi,lambda)',
                      'gate_ops_list': [   {   'op': 'U',
                                               'op_param_list': [   'pi/2',
                                                                    'phi',
                                                                    'lambda'],
                                               'op_reg_list': ['q']}],
                      'gate_ops_raw_list': ['U(pi/2,phi,lambda) q;'],
                      'gate_param_list': ['q'],
                      'linenum': 8,
                      'source': 'gate u2(phi,lambda) q { U(pi/2,phi,lambda) q; '
                                '}'},
                  {   'filenum': 1,
                      'gate_name': 'u1(lambda)',
                      'gate_ops_list': [   {   'op': 'U',
                                               'op_param_list': [   '0',
                                                                    '0',
                                                                    'lambda'],
                                               'op_reg_list': ['q']}],
                      'gate_ops_raw_list': ['U(0,0,lambda) q;'],
                      'gate_param_list': ['q'],
                      'linenum': 10,
                      'source': 'gate u1(lambda) q { U(0,0,lambda) q; }'},
                  {   'filenum': 1,
                      'gate_name': 'cx',
                      'gate_ops_list': [   {   'op': 'CX',
                                               'op_param_list': None,
                                               'op_reg_list': ['c', 't']}],
                      'gate_ops_raw_list': ['CX c,t;'],
                      'gate_param_list': ['c', 't'],
                      'linenum': 12,
                      'source': 'gate cx c,t { CX c,t; }'},
                  {   'filenum': 1,
                      'gate_name': 'id',
                      'gate_ops_list': [   {   'op': 'U',
                                               'op_param_list': ['0', '0', '0'],
                                               'op_reg_list': ['a']}],
                      'gate_ops_raw_list': ['U(0,0,0) a;'],
                      'gate_param_list': ['a'],
                      'linenum': 14,
                      'source': 'gate id a { U(0,0,0) a; }'},
                  {   'filenum': 1,
                      'gate_name': 'u0(gamma)',
                      'gate_ops_list': [   {   'op': 'U',
                                               'op_param_list': ['0', '0', '0'],
                                               'op_reg_list': ['q']}],
                      'gate_ops_raw_list': ['U(0,0,0) q;'],
                      'gate_param_list': ['q'],
                      'linenum': 16,
                      'source': 'gate u0(gamma) q { U(0,0,0) q; }'},
                  {   'filenum': 1,
                      'gate_name': 'x',
                      'gate_ops_list': [   {   'op': 'u3',
                                               'op_param_list': [   'pi',
                                                                    '0',
                                                                    'pi'],
                                               'op_reg_list': ['a']}],
                      'gate_ops_raw_list': ['u3(pi,0,pi) a;'],
                      'gate_param_list': ['a'],
                      'linenum': 21,
                      'source': 'gate x a { u3(pi,0,pi) a; }'},
                  {   'filenum': 1,
                      'gate_name': 'y',
                      'gate_ops_list': [   {   'op': 'u3',
                                               'op_param_list': [   'pi',
                                                                    'pi/2',
                                                                    'pi/2'],
                                               'op_reg_list': ['a']}],
                      'gate_ops_raw_list': ['u3(pi,pi/2,pi/2) a;'],
                      'gate_param_list': ['a'],
                      'linenum': 23,
                      'source': 'gate y a { u3(pi,pi/2,pi/2) a; }'},
                  {   'filenum': 1,
                      'gate_name': 'z',
                      'gate_ops_list': [   {   'op': 'u1',
                                               'op_param_list': ['pi'],
                                               'op_reg_list': ['a']}],
                      'gate_ops_raw_list': ['u1(pi) a;'],
                      'gate_param_list': ['a'],
                      'linenum': 25,
                      'source': 'gate z a { u1(pi) a; }'},
                  {   'filenum': 1,
                      'gate_name': 'h',
                      'gate_ops_list': [   {   'op': 'u2',
                                               'op_param_list': ['0', 'pi'],
                                               'op_reg_list': ['a']}],
                      'gate_ops_raw_list': ['u2(0,pi) a;'],
                      'gate_param_list': ['a'],
                      'linenum': 27,
                      'source': 'gate h a { u2(0,pi) a; }'},
                  {   'filenum': 1,
                      'gate_name': 's',
                      'gate_ops_list': [   {   'op': 'u1',
                                               'op_param_list': ['pi/2'],
                                               'op_reg_list': ['a']}],
                      'gate_ops_raw_list': ['u1(pi/2) a;'],
                      'gate_param_list': ['a'],
                      'linenum': 29,
                      'source': 'gate s a { u1(pi/2) a; }'},
                  {   'filenum': 1,
                      'gate_name': 'sdg',
                      'gate_ops_list': [   {   'op': 'u1',
                                               'op_param_list': ['-pi/2'],
                                               'op_reg_list': ['a']}],
                      'gate_ops_raw_list': ['u1(-pi/2) a;'],
                      'gate_param_list': ['a'],
                      'linenum': 31,
                      'source': 'gate sdg a { u1(-pi/2) a; }'},
                  {   'filenum': 1,
                      'gate_name': 't',
                      'gate_ops_list': [   {   'op': 'u1',
                                               'op_param_list': ['pi/4'],
                                               'op_reg_list': ['a']}],
                      'gate_ops_raw_list': ['u1(pi/4) a;'],
                      'gate_param_list': ['a'],
                      'linenum': 33,
                      'source': 'gate t a { u1(pi/4) a; }'},
                  {   'filenum': 1,
                      'gate_name': 'tdg',
                      'gate_ops_list': [   {   'op': 'u1',
                                               'op_param_list': ['-pi/4'],
                                               'op_reg_list': ['a']}],
                      'gate_ops_raw_list': ['u1(-pi/4) a;'],
                      'gate_param_list': ['a'],
                      'linenum': 35,
                      'source': 'gate tdg a { u1(-pi/4) a; }'},
                  {   'filenum': 1,
                      'gate_name': 'rx(theta)',
                      'gate_ops_list': [   {   'op': 'u3',
                                               'op_param_list': [   'theta',
                                                                    '-pi/2',
                                                                    'pi/2'],
                                               'op_reg_list': ['a']}],
                      'gate_ops_raw_list': ['u3(theta,-pi/2,pi/2) a;'],
                      'gate_param_list': ['a'],
                      'linenum': 39,
                      'source': 'gate rx(theta) a { u3(theta,-pi/2,pi/2) a; }'},
                  {   'filenum': 1,
                      'gate_name': 'ry(theta)',
                      'gate_ops_list': [   {   'op': 'u3',
                                               'op_param_list': [   'theta',
                                                                    '0',
                                                                    '0'],
                                               'op_reg_list': ['a']}],
                      'gate_ops_raw_list': ['u3(theta,0,0) a;'],
                      'gate_param_list': ['a'],
                      'linenum': 41,
                      'source': 'gate ry(theta) a { u3(theta,0,0) a; }'},
                  {   'filenum': 1,
                      'gate_name': 'rz(phi)',
                      'gate_ops_list': [   {   'op': 'u1',
                                               'op_param_list': ['phi'],
                                               'op_reg_list': ['a']}],
                      'gate_ops_raw_list': ['u1(phi) a;'],
                      'gate_param_list': ['a'],
                      'linenum': 43,
                      'source': 'gate rz(phi) a { u1(phi) a; }'},
                  {   'filenum': 1,
                      'gate_name': 'cz',
                      'gate_ops_list': [   {   'op': 'h',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']},
                                           {   'op': 'h',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']}],
                      'gate_ops_raw_list': ['h b;', 'cx a,b;', 'h b;'],
                      'gate_param_list': ['a', 'b'],
                      'linenum': 48,
                      'source': 'gate cz a,b { h b; cx a,b; h b; }'},
                  {   'filenum': 1,
                      'gate_name': 'cy',
                      'gate_ops_list': [   {   'op': 'sdg',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']},
                                           {   'op': 's',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']}],
                      'gate_ops_raw_list': ['sdg b;', 'cx a,b;', 's b;'],
                      'gate_param_list': ['a', 'b'],
                      'linenum': 50,
                      'source': 'gate cy a,b { sdg b; cx a,b; s b; }'},
                  {   'filenum': 1,
                      'gate_name': 'swap',
                      'gate_ops_list': [   {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['b', 'a']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']}],
                      'gate_ops_raw_list': ['cx a,b;', 'cx b,a;', 'cx a,b;'],
                      'gate_param_list': ['a', 'b'],
                      'linenum': 52,
                      'source': 'gate swap a,b { cx a,b; cx b,a; cx a,b; }'},
                  {   'filenum': 1,
                      'gate_name': 'ch',
                      'gate_ops_list': [   {   'op': 'h',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']},
                                           {   'op': 'sdg',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']},
                                           {   'op': 'h',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']},
                                           {   'op': 't',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']},
                                           {   'op': 't',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']},
                                           {   'op': 'h',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']},
                                           {   'op': 's',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']},
                                           {   'op': 'x',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']},
                                           {   'op': 's',
                                               'op_param_list': None,
                                               'op_reg_list': ['a']}],
                      'gate_ops_raw_list': [   'h b;',
                                               'sdg b;',
                                               'cx a,b;',
                                               'h b;',
                                               't b;',
                                               'cx a,b;',
                                               't b;',
                                               'h b;',
                                               's b;',
                                               'x b;',
                                               's a;'],
                      'gate_param_list': ['a', 'b'],
                      'linenum': 54,
                      'source': 'gate ch a,b { h b; sdg b; cx a,b; h b; t b; '
                                'cx a,b; t b; h b; s b; x b; s a; }'},
                  {   'filenum': 1,
                      'gate_name': 'ccx',
                      'gate_ops_list': [   {   'op': 'h',
                                               'op_param_list': None,
                                               'op_reg_list': ['c']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['b', 'c']},
                                           {   'op': 'tdg',
                                               'op_param_list': None,
                                               'op_reg_list': ['c']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'c']},
                                           {   'op': 't',
                                               'op_param_list': None,
                                               'op_reg_list': ['c']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['b', 'c']},
                                           {   'op': 'tdg',
                                               'op_param_list': None,
                                               'op_reg_list': ['c']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'c']},
                                           {   'op': 't',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']},
                                           {   'op': 't',
                                               'op_param_list': None,
                                               'op_reg_list': ['c']},
                                           {   'op': 'h',
                                               'op_param_list': None,
                                               'op_reg_list': ['c']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']},
                                           {   'op': 't',
                                               'op_param_list': None,
                                               'op_reg_list': ['a']},
                                           {   'op': 'tdg',
                                               'op_param_list': None,
                                               'op_reg_list': ['b']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']}],
                      'gate_ops_raw_list': [   'h c;',
                                               'cx b,c;',
                                               'tdg c;',
                                               'cx a,c;',
                                               't c;',
                                               'cx b,c;',
                                               'tdg c;',
                                               'cx a,c;',
                                               't b;',
                                               't c;',
                                               'h c;',
                                               'cx a,b;',
                                               't a;',
                                               'tdg b;',
                                               'cx a,b;'],
                      'gate_param_list': ['a', 'b', 'c'],
                      'linenum': 62,
                      'source': 'gate ccx a,b,c { h c; cx b,c; tdg c; cx a,c; '
                                't c; cx b,c; tdg c; cx a,c; t b; t c; h c; cx '
                                'a,b; t a; tdg b; cx a,b; }'},
                  {   'filenum': 1,
                      'gate_name': 'cswap',
                      'gate_ops_list': [   {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['c', 'b']},
                                           {   'op': 'ccx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b', 'c']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['c', 'b']}],
                      'gate_ops_raw_list': ['cx c,b;', 'ccx a,b,c;', 'cx c,b;'],
                      'gate_param_list': ['a', 'b', 'c'],
                      'linenum': 73,
                      'source': 'gate cswap a,b,c { cx c,b; ccx a,b,c; cx c,b; '
                                '}'},
                  {   'filenum': 1,
                      'gate_name': 'crz(lambda)',
                      'gate_ops_list': [   {   'op': 'u1',
                                               'op_param_list': ['lambda/2'],
                                               'op_reg_list': ['b']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']},
                                           {   'op': 'u1',
                                               'op_param_list': ['-lambda/2'],
                                               'op_reg_list': ['b']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']}],
                      'gate_ops_raw_list': [   'u1(lambda/2) b;',
                                               'cx a,b;',
                                               'u1(-lambda/2) b;',
                                               'cx a,b;'],
                      'gate_param_list': ['a', 'b'],
                      'linenum': 80,
                      'source': 'gate crz(lambda) a,b { u1(lambda/2) b; cx '
                                'a,b; u1(-lambda/2) b; cx a,b; }'},
                  {   'filenum': 1,
                      'gate_name': 'cu1(lambda)',
                      'gate_ops_list': [   {   'op': 'u1',
                                               'op_param_list': ['lambda/2'],
                                               'op_reg_list': ['a']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']},
                                           {   'op': 'u1',
                                               'op_param_list': ['-lambda/2'],
                                               'op_reg_list': ['b']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']},
                                           {   'op': 'u1',
                                               'op_param_list': ['lambda/2'],
                                               'op_reg_list': ['b']}],
                      'gate_ops_raw_list': [   'u1(lambda/2) a;',
                                               'cx a,b;',
                                               'u1(-lambda/2) b;',
                                               'cx a,b;',
                                               'u1(lambda/2) b;'],
                      'gate_param_list': ['a', 'b'],
                      'linenum': 88,
                      'source': 'gate cu1(lambda) a,b { u1(lambda/2) a; cx '
                                'a,b; u1(-lambda/2) b; cx a,b; u1(lambda/2) b; '
                                '}'},
                  {   'filenum': 1,
                      'gate_name': 'cu3(theta,phi,lambda)',
                      'gate_ops_list': [   {   'op': 'u1',
                                               'op_param_list': [   'lambda-phi)/2'],
                                               'op_reg_list': ['t']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['c', 't']},
                                           {   'op': 'u3',
                                               'op_param_list': [   'phi+lambda)/2'],
                                               'op_reg_list': ['t']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['c', 't']},
                                           {   'op': 'u3',
                                               'op_param_list': [   'theta/2',
                                                                    'phi',
                                                                    '0'],
                                               'op_reg_list': ['t']}],
                      'gate_ops_raw_list': [   'u1((lambda-phi)/2) t;',
                                               'cx c,t;',
                                               'u3(-theta/2,0,-(phi+lambda)/2) '
                                               't;',
                                               'cx c,t;',
                                               'u3(theta/2,phi,0) t;'],
                      'gate_param_list': ['c', 't'],
                      'linenum': 97,
                      'source': 'gate cu3(theta,phi,lambda) c,t { // '
                                'implements controlled-U(theta,phi,lambda) '
                                'with  target t and control c '
                                'u1((lambda-phi)/2) t; cx c,t; '
                                'u3(-theta/2,0,-(phi+lambda)/2) t; cx c,t; '
                                'u3(theta/2,phi,0) t; }'},
                  {   'filenum': 1,
                      'gate_name': 'rzz(theta)',
                      'gate_ops_list': [   {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']},
                                           {   'op': 'u1',
                                               'op_param_list': ['theta'],
                                               'op_reg_list': ['b']},
                                           {   'op': 'cx',
                                               'op_param_list': None,
                                               'op_reg_list': ['a', 'b']}],
                      'gate_ops_raw_list': [   'cx a,b;',
                                               'u1(theta) b;',
                                               'cx a,b;'],
                      'gate_param_list': ['a', 'b'],
                      'linenum': 107,
                      'source': 'gate rzz(theta) a,b { cx a,b; u1(theta) b; cx '
                                'a,b; }'}],
    's_sect': [   {   'filenum': 0,
                      'source': [   '// ghzyyx',
                                    'OPENQASM 2.0;',
                                    'include "qelib1.inc";',
                                    'qreg q[3];',
                                    'creg c[3];',
                                    'x q[0];',
                                    'h q[1];',
                                    'h q[2];',
                                    'cx q[1],q[0];',
                                    'cx q[2],q[0];',
                                    'h q[0];',
                                    'h q[1];',
                                    'h q[2];',
                                    'barrier q[0],q[1],q[2];',
                                    'sdg q[1];',
                                    'sdg q[2];',
                                    'h q[0];',
                                    'h q[1];',
                                    'h q[2];',
                                    'measure q[0] -> c[0];',
                                    'measure q[1] -> c[1];',
                                    'measure q[2] -> c[2];',
                                    '']},
                  {   'filenum': 1,
                      'source': [   '// Quantum Experience (QE) Standard '
                                    'Header',
                                    '// file: qelib1.inc',
                                    '',
                                    '// --- QE Hardware primitives ---',
                                    '',
                                    '// 3-parameter 2-pulse single qubit gate',
                                    'gate u3(theta,phi,lambda) q { '
                                    'U(theta,phi,lambda) q; }',
                                    '// 2-parameter 1-pulse single qubit gate',
                                    'gate u2(phi,lambda) q { '
                                    'U(pi/2,phi,lambda) q; }',
                                    '// 1-parameter 0-pulse single qubit gate',
                                    'gate u1(lambda) q { U(0,0,lambda) q; }',
                                    '// controlled-NOT',
                                    'gate cx c,t { CX c,t; }',
                                    '// idle gate (identity)',
                                    'gate id a { U(0,0,0) a; }',
                                    '// idle gate (identity) with length '
                                    'gamma*sqglen',
                                    'gate u0(gamma) q { U(0,0,0) q; }',
                                    '',
                                    '// --- QE Standard Gates ---',
                                    '',
                                    '// Pauli gate: bit-flip',
                                    'gate x a { u3(pi,0,pi) a; }',
                                    '// Pauli gate: bit and phase flip',
                                    'gate y a { u3(pi,pi/2,pi/2) a; }',
                                    '// Pauli gate: phase flip',
                                    'gate z a { u1(pi) a; }',
                                    '// Clifford gate: Hadamard',
                                    'gate h a { u2(0,pi) a; }',
                                    '// Clifford gate: sqrt(Z) phase gate',
                                    'gate s a { u1(pi/2) a; }',
                                    '// Clifford gate: conjugate of sqrt(Z)',
                                    'gate sdg a { u1(-pi/2) a; }',
                                    '// C3 gate: sqrt(S) phase gate',
                                    'gate t a { u1(pi/4) a; }',
                                    '// C3 gate: conjugate of sqrt(S)',
                                    'gate tdg a { u1(-pi/4) a; }',
                                    '',
                                    '// --- Standard rotations ---',
                                    '// Rotation around X-axis',
                                    'gate rx(theta) a { u3(theta, -pi/2,pi/2) '
                                    'a; }',
                                    '// rotation around Y-axis',
                                    'gate ry(theta) a { u3(theta,0,0) a; }',
                                    '// rotation around Z axis',
                                    'gate rz(phi) a { u1(phi) a; }',
                                    '',
                                    '// --- QE Standard User-Defined Gates  '
                                    '---',
                                    '',
                                    '// controlled-Phase',
                                    'gate cz a,b { h b; cx a,b; h b; }',
                                    '// controlled-Y',
                                    'gate cy a,b { sdg b; cx a,b; s b; }',
                                    '// swap',
                                    'gate swap a,b { cx a,b; cx b,a; cx a,b; }',
                                    '// controlled-H',
                                    'gate ch a,b {',
                                    'h b; sdg b;',
                                    'cx a,b;',
                                    'h b; t b;',
                                    'cx a,b;',
                                    't b; h b; s b; x b; s a;',
                                    '}',
                                    '// C3 gate: Toffoli',
                                    'gate ccx a,b,c',
                                    '{',
                                    'h c;',
                                    'cx b,c; tdg c;',
                                    'cx a,c; t c;',
                                    'cx b,c; tdg c;',
                                    'cx a,c; t b; t c; h c;',
                                    'cx a,b; t a; tdg b;',
                                    'cx a,b;',
                                    '}',
                                    '// cswap (Fredkin)',
                                    'gate cswap a,b,c',
                                    '{',
                                    'cx c,b;',
                                    'ccx a,b,c;',
                                    'cx c,b;',
                                    '}',
                                    '// controlled rz rotation',
                                    'gate crz(lambda) a,b',
                                    '{',
                                    'u1(lambda/2) b;',
                                    'cx a,b;',
                                    'u1(-lambda/2) b;',
                                    'cx a,b;',
                                    '}',
                                    '// controlled phase rotation',
                                    'gate cu1(lambda) a,b',
                                    '{',
                                    'u1(lambda/2) a;',
                                    'cx a,b;',
                                    'u1(-lambda/2) b;',
                                    'cx a,b;',
                                    'u1(lambda/2) b;',
                                    '}',
                                    '// controlled-U',
                                    'gate cu3(theta,phi,lambda) c, t',
                                    '{',
                                    '// implements '
                                    'controlled-U(theta,phi,lambda) with  '
                                    'target t and control c',
                                    'u1((lambda-phi)/2) t;',
                                    'cx c,t;',
                                    'u3(-theta/2,0,-(phi+lambda)/2) t;',
                                    'cx c,t;',
                                    'u3(theta/2,phi,0) t;',
                                    '}',
                                    '// two-qubit ZZ rotation',
                                    'gate rzz(theta) a,b',
                                    '{',
                                    'cx a,b;',
                                    'u1(theta) b;',
                                    'cx a,b;',
                                    '}']}],
    't_sect': {   'datetime_finish': '2019-04-06T17:20:20.269724',
                  'datetime_start': '2019-04-06T17:20:20.265630',
                  'filepaths': [   'test_qasm/ghzyyx.qasm',
                                   '../DEV/qiskit-terra/qiskit/qasm/libs/qelib1.inc'],
                  'name': 'main'}}
```
